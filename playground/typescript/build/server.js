;var {$serpack_cache}=require("@zely-js/optimizer");
(function(modules) {
  var __serpack_module_cache__={};
  function __serpack_require__(id){
    if (!id.startsWith("sp:")) return require(id);
    if (__serpack_module_cache__[id.slice(3)]) return __serpack_module_cache__[id.slice(3)];
    const module={exports:{}};
    __serpack_module_cache__[id.slice(3)]="__serpack_module_pending__";
    modules[id.slice(3)].call(module.exports, __serpack_require__, require, module, module.exports);
    __serpack_module_cache__[id.slice(3)]=module.exports;
    return module.exports;
  }
  module.exports=__serpack_require__("sp:0");
})({
/* D:\zelx\playground\typescript\build\server.js */ "0": (function(__serpack_require__,__non_serpack_require__,module,exports) { 'use strict';var e=__serpack_require__('sp:1');var r=__serpack_require__('sp:2');if(!e.__virtuals__){e.__virtuals__=[];}e.__virtuals__.push(...r.default||r);e.cwd=__dirname;__serpack_require__('@zely-js/zely').zely(e).then(r=>{r.server.listen(e.port||8080);console.log(`server is running on http://localhost:${e.port||8080}`);}); }),
/* D:\zelx\playground\typescript\build\_config.js */ "1": (function(__serpack_require__,__non_serpack_require__,module,exports) { 'use strict';var {$serpack_cache:e}=__serpack_require__('sp:3');(function(e){var r={};function __serpack_require__(t){if(!t.startsWith('sp:'))return require(t);if(r[t.slice(3)])return r[t.slice(3)];const n={exports:{}};r[t.slice(3)]='__serpack_module_pending__';e[t.slice(3)].call(n.exports,__serpack_require__,require,n,n.exports);r[t.slice(3)]=n.exports;return n.exports;}module.exports=__serpack_require__('sp:0');}({'0':function(e,r,t,n){'use strict';Object.defineProperty(n,'__esModule',{value:true});Object.defineProperty(n,'default',{enumerable:true,get:function(){return a;}});const o=e('@zely-js/core');const i=e('@zely-js/zely');const u=e('sp:1');function asyncGeneratorStep(e,r,t,n,o,i,u){try{var a=e[i](u);var s=a.value;}catch(e){t(e);return;}if(a.done){r(s);}else{Promise.resolve(s).then(n,o);}}function _async_to_generator(e){return function(){var r=this,t=arguments;return new Promise(function(n,o){var i=e.apply(r,t);function _next(e){asyncGeneratorStep(i,n,o,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(i,n,o,_next,_throw,'throw',e);}_next(undefined);});};}(0,o.setSender)(function(){var e=_async_to_generator(function*(e,r,t,n){(0,o.defaultSender)(e,r,t,n);});return function(r,t,n,o){return e.apply(this,arguments);};}());const a=(0,i.defineConfig)({server:{port:3001},experimental:{useHTML:true},allowAutoMiddlewares:true,middlewares:[u.bodyMiddleware],__virtuals__:[(0,o.createVirtualPage)('main.ts',[(0,o.GET)(()=>{})])]});},'1':function(e,r,t,n){'use strict';Object.defineProperty(n,'__esModule',{value:true});Object.defineProperty(n,'bodyMiddleware',{enumerable:true,get:function(){return bodyMiddleware;}});const o=e('node:module');const i=e('node:url');var u=(0,i.fileURLToPath)(e('url').pathToFileURL(__filename).toString());var a=(0,i.fileURLToPath)(new URL('.',e('url').pathToFileURL(__filename).toString()));var s=(0,o.createRequire)(e('url').pathToFileURL(__filename).toString());var bodyMiddleware=(e,r)=>{let t='';e.request.on('data',e=>{t+=e.toString();});e.request.on('end',()=>{try{e.body=JSON.parse(t||'{}');}catch(r){e.body={};}e.request.body=e.body;r();});};}}));Object.defineProperty(module.exports,'__serpack_module__',{value:!0,enumerable:!!0});var {$serpack_cache:e}=__serpack_require__('sp:3'); }),
/* D:\zelx\packages\zely-js-optimizer\dist\index.mjs */ "3": (function(__serpack_require__,__non_serpack_require__,module,exports) { 'use strict';Object.defineProperty(exports,'__esModule',{value:true});function _export(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:true,get:r[t]});}_export(exports,{$serpack_cache:function(){return $serpack_cache;},optimizer:function(){return optimizer;}});const e=__serpack_require__('node:module');const r=__serpack_require__('node:url');function asyncGeneratorStep(e,r,t,n,i,o,a){try{var c=e[o](a);var s=c.value;}catch(e){t(e);return;}if(c.done){r(s);}else{Promise.resolve(s).then(n,i);}}function _async_to_generator(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var o=e.apply(r,t);function _next(e){asyncGeneratorStep(o,n,i,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(o,n,i,_next,_throw,'throw',e);}_next(undefined);});};}function _define_property(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true});}else{e[r]=t;}return e;}var t=(0,r.fileURLToPath)(__serpack_require__('url').pathToFileURL(__filename).toString());var n=(0,r.fileURLToPath)(new URL('.',__serpack_require__('url').pathToFileURL(__filename).toString()));var i=(0,e.createRequire)(__serpack_require__('url').pathToFileURL(__filename).toString());function isPromise(e){return e instanceof Promise;}var o=class{clearExpired(){const e=Date.now();for(const r in this.cache){const t=e-this.cache[r].timestamp;if(t>this.ttl){delete this.cache[r];}}}set(e,r){this.clearExpired();this.cache[e]={value:r,timestamp:Date.now()};}get(e){this.clearExpired();const r=this.cache[e];return r?r.value:null;}length(){return Object.keys(this.cache).length;}constructor(e){_define_property(this,'ttl',void 0);_define_property(this,'cache',void 0);this.ttl=e;this.cache={};}};var a=new o(1000*60*6);function $serpack_cache(e,r,t){return _$serpack_cache.apply(this,arguments);}function _$serpack_cache(){_$serpack_cache=_async_to_generator(function*(e,r,t){if(!isPromise(e)){return e;}const n=`${t}-${r.__DEV__.path}-${Object.values(r.params).join('-')}`;const i=a.get(n);if(i){return i;}const o=yield e;a.set(n,o);return o;});return _$serpack_cache.apply(this,arguments);}function getCallerName(e){if(!e)return null;if(e.type==='Identifier'){return e.name;}if(e.type==='MemberExpression'){return getCallerName(e.property);}return null;}function optimizer(e){return{name:'@zely-js/optimizer',onSetup(e){var r;if((r=e.modifier)===null||r===void 0?void 0:r.caller){throw new Error('A crash occurred while applying the optimization plugin. Please remove @zely-js/optimizer or resolve other conflict factors (serpackOptions.modifier.caller).');}else{e.modifier={};}e.swcOptions={jsc:{minify:{compress:false,keep_fnames:true}}};e.banner=`${e.banner||''};var {$serpack_cache}=require("@zely-js/optimizer");`;e.modifier.caller=e=>{const r=getCallerName(e.callee);if(!(r===null||r===void 0?void 0:r.startsWith('$')))return e;const t={type:'CallExpression',callee:{type:'Identifier',name:'$serpack_cache'},arguments:[e,{type:'MemberExpression',object:{type:'ThisExpression'},property:{type:'Identifier',name:'context'},computed:false,optional:false},{type:'Literal',value:r,raw:`'${r}'`}]};return t;};}};} }),
/* D:\zelx\playground\typescript\build\_pages.js */ "2": (function(__serpack_require__,__non_serpack_require__,module,exports) { 'use strict';var {$serpack_cache:e}=__serpack_require__('sp:3');(function(e){var t={};function __serpack_require__(r){if(!r.startsWith('sp:'))return require(r);if(t[r.slice(3)])return t[r.slice(3)];const n={exports:{}};t[r.slice(3)]='__serpack_module_pending__';e[r.slice(3)].call(n.exports,__serpack_require__,require,n,n.exports);t[r.slice(3)]=n.exports;return n.exports;}module.exports=__serpack_require__('sp:0');}({'0':function(e,t,r,n){'use strict';var __exports__=e=>e.default||e;var s=e('@zely-js/zely');r.exports=[s.createVirtualPage('index',__exports__(e('sp:1'))),s.createVirtualPage('[params]/index',__exports__(e('sp:2'))),s.createVirtualPage('[params]/test',__exports__(e('sp:3'))),s.createVirtualPage('_404',__exports__(e('sp:4')))];},'1':function(t,r,n,s){'use strict';var {$serpack_cache:i}=t('sp:5');(function(e){var t={};function __serpack_require__(r){if(!r.startsWith('sp:'))return require(r);if(t[r.slice(3)])return t[r.slice(3)];const n={exports:{}};t[r.slice(3)]='__serpack_module_pending__';e[r.slice(3)].call(n.exports,__serpack_require__,require,n,n.exports);t[r.slice(3)]=n.exports;return n.exports;}n.exports=__serpack_require__('sp:0');}({'0':function(t,r,n,s){'use strict';Object.defineProperty(s,'__esModule',{value:true});Object.defineProperty(s,'default',{enumerable:true,get:function(){return a;}});const o=t('@zely-js/core');const c=t('timers/promises');function asyncGeneratorStep(e,t,r,n,s,i,o){try{var c=e[i](o);var a=c.value;}catch(e){r(e);return;}if(c.done){t(a);}else{Promise.resolve(a).then(n,s);}}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,s,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(i,n,s,_next,_throw,'throw',e);}_next(undefined);});};}function $greeting(){return _$greeting.apply(this,arguments);}function _$greeting(){_$greeting=_async_to_generator(function*(){yield(0,c.setTimeout)(1000);return'Hello!';});return _$greeting.apply(this,arguments);}const a=[(0,o.ALL)(_async_to_generator(function*(){const t=(0,o.response)({msg:yield i(e($serpack_cache($greeting(),this.context,'$greeting'),this.context,'$greeting'),this.context,'$greeting'),name:''},{});t.headers={};t.status=200;return t;}))];}}));Object.defineProperty(n.exports,'__serpack_module__',{value:!0,enumerable:!!0});var {$serpack_cache:i}=t('sp:5');},'5':function(e,t,r,n){'use strict';Object.defineProperty(n,'__esModule',{value:true});function _export(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:true,get:t[r]});}_export(n,{$serpack_cache:function(){return $serpack_cache;},optimizer:function(){return optimizer;}});const s=e('node:module');const i=e('node:url');function asyncGeneratorStep(e,t,r,n,s,i,o){try{var c=e[i](o);var a=c.value;}catch(e){r(e);return;}if(c.done){t(a);}else{Promise.resolve(a).then(n,s);}}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,s,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(i,n,s,_next,_throw,'throw',e);}_next(undefined);});};}function _define_property(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});}else{e[t]=r;}return e;}var o=(0,i.fileURLToPath)(e('url').pathToFileURL(__filename).toString());var c=(0,i.fileURLToPath)(new URL('.',e('url').pathToFileURL(__filename).toString()));var a=(0,s.createRequire)(e('url').pathToFileURL(__filename).toString());function isPromise(e){return e instanceof Promise;}var u=class{clearExpired(){const e=Date.now();for(const t in this.cache){const r=e-this.cache[t].timestamp;if(r>this.ttl){delete this.cache[t];}}}set(e,t){this.clearExpired();this.cache[e]={value:t,timestamp:Date.now()};}get(e){this.clearExpired();const t=this.cache[e];return t?t.value:null;}length(){return Object.keys(this.cache).length;}constructor(e){_define_property(this,'ttl',void 0);_define_property(this,'cache',void 0);this.ttl=e;this.cache={};}};var _=new u(1000*60*6);function $serpack_cache(e,t,r){return _$serpack_cache.apply(this,arguments);}function _$serpack_cache(){_$serpack_cache=_async_to_generator(function*(e,t,r){if(!isPromise(e)){return e;}const n=`${r}-${t.__DEV__.path}-${Object.values(t.params).join('-')}`;const s=_.get(n);if(s){return s;}const i=yield e;_.set(n,i);return i;});return _$serpack_cache.apply(this,arguments);}function getCallerName(e){if(!e)return null;if(e.type==='Identifier'){return e.name;}if(e.type==='MemberExpression'){return getCallerName(e.property);}return null;}function optimizer(e){return{name:'@zely-js/optimizer',onSetup(e){var t;if((t=e.modifier)===null||t===void 0?void 0:t.caller){throw new Error('A crash occurred while applying the optimization plugin. Please remove @zely-js/optimizer or resolve other conflict factors (serpackOptions.modifier.caller).');}else{e.modifier={};}e.swcOptions={jsc:{minify:{compress:false,keep_fnames:true}}};e.banner=`${e.banner||''};var {$serpack_cache}=require("@zely-js/optimizer");`;e.modifier.caller=e=>{const t=getCallerName(e.callee);if(!(t===null||t===void 0?void 0:t.startsWith('$')))return e;const r={type:'CallExpression',callee:{type:'Identifier',name:'$serpack_cache'},arguments:[e,{type:'MemberExpression',object:{type:'ThisExpression'},property:{type:'Identifier',name:'context'},computed:false,optional:false},{type:'Literal',value:t,raw:`'${t}'`}]};return r;};}};}},'2':function(e,t,r,n){'use strict';function asyncGeneratorStep(e,t,r,n,s,i,o){try{var c=e[i](o);var a=c.value;}catch(e){r(e);return;}if(c.done){t(a);}else{Promise.resolve(a).then(n,s);}}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,s,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(i,n,s,_next,_throw,'throw',e);}_next(undefined);});};}const s=e('@zely-js/core');const {serverRender:i}=e('segify');const o=s.logger;var c=function(){var e=_async_to_generator(function*(e){let t='';let r=`<script>
  $.count = 0;

  function increment() {
    $.count += 1;
  }
</script>

<div>
  <h1>Hello, {{$.params.params}}: {{ $.count }}</h1>
  <button $onclick="increment">Add</button>
</div>
`;try{var n=yield i(r,{params:e.params});t=n.output.map(e=>e.getText()).join('');}catch(e){o.warn('Error occurred while compiling server-side rendered HTML. '+e.message);t='';}return t;});return function $$ssrCompiler(t){return e.apply(this,arguments);};}();r.exports=[s.GET(function(){var e=_async_to_generator(function*(e){return e.html(`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="module">/*[params]\\index.html*/var p=(n,e,s=[],c={})=>{e.children=[].concat(...s);for(let $ in e)if(Array.isArray(e[$])&&e[$].length===2&&Array.isArray(e[$][0])&&typeof e[$][1]=="string"){let[i,o]=e[$];for(let l of i)o=o.replace(l,c[l]());e[$]=o}let r=new n(e),t=r.$components();return r.$stylesheet(),r.$event(),t},a=(n,e,s=[],c={})=>{if(typeof n!="string")return p(n,e,s,c);let r=document.createElement(n);for(let t in e)if(Array.isArray(e[t])){let[$,i]=e[t];for(let o of $)i=i.replace(o,c[o]());r.setAttribute(t,i)}else r.setAttribute(t,e[t]);for(let t of s)Array.isArray(t)&&t.forEach($=>{r.appendChild($)}),f(t)&&r.appendChild(t);return r},u=n=>document.createTextNode(n),d=(n,e=!0,s=[])=>{let c=$=>Array.isArray($)?$:[$],r=n();if(Array.isArray(r))return c(r);let t=document.createTextNode(r);return e&&s.push([t,n]),c(t)};function f(n){return window.__env__==="ssr"?n?.__component__:n instanceof Element||n instanceof HTMLDocument||n instanceof Text}var _=(n,e,s)=>(n&&(n=s),e&&e(s),s);window.$$={$cc:p,$ce:a,$ct:u,$cd:d,$isElement:f,$mount:_};var h=class{$subscribe=[];constructor(e){var s=[],c=[],r=new Proxy({__props__:{}},{set(t,$,i){t[$]=i;for(let o of s)o[0].nodeValue=o[1]();return!0}});Object.keys(e).forEach(t=>r[t]=e[t]),this.$=r,this.$events=c,this.$subscribe=s}$kill(){this.$events.forEach(e=>e[1].removeEventListener(e[0],e[2]))}$components(){let{$:e,$events:s,$subscribe:c}=this;var r={$0$:()=>e.params.params,$1$:()=>e.count};this.$DEV_PROPS=r,e.count=0;function t(){e.count+=1}return[a("div",{},[a("h1",{},[u("Hello, "),...d(r.$0$,!0,this.$subscribe),u(": "),...d(r.$1$,!0,this.$subscribe)],this.$DEV_PROPS),s.push(["click",a("button",{},[u("Add")],this.$DEV_PROPS),t])&&s[s.length-1][1]],this.$DEV_PROPS)]}$stylesheet(){var e=document.createElement("style");return e.innerHTML="",e}$event(){this.$events.forEach(e=>e[1].addEventListener(e[0],e[2]))}render(e){document.head.appendChild(this.$stylesheet()),[].concat(...this.$components()).filter(f).forEach(s=>e.appendChild(s)),this.$event()}};var y=JSON.parse(document.getElementById("__fe_props").innerText);document.getElementById("__fe").innerHTML="";var m=new h(y);m.render(document.getElementById("__fe"));export{h as Component,h as default};
</script>
</head>
<body>
  <div id="__fe">%ssr%</div><script id="__fe_props" type="application/json">%props%</script>
</body>
</html>
`.replace('%ssr%',yield c(e)).replace('%props%',JSON.stringify({params:e.params})));});return function(t){return e.apply(this,arguments);};}())];},'3':function(t,r,n,s){'use strict';var {$serpack_cache:i}=t('sp:5');(function(e){var t={};function __serpack_require__(r){if(!r.startsWith('sp:'))return require(r);if(t[r.slice(3)])return t[r.slice(3)];const n={exports:{}};t[r.slice(3)]='__serpack_module_pending__';e[r.slice(3)].call(n.exports,__serpack_require__,require,n,n.exports);t[r.slice(3)]=n.exports;return n.exports;}n.exports=__serpack_require__('sp:0');}({'0':function(t,r,n,s){'use strict';Object.defineProperty(s,'__esModule',{value:true});Object.defineProperty(s,'default',{enumerable:true,get:function(){return a;}});const o=t('@zely-js/core');const c=t('timers/promises');function asyncGeneratorStep(e,t,r,n,s,i,o){try{var c=e[i](o);var a=c.value;}catch(e){r(e);return;}if(c.done){t(a);}else{Promise.resolve(a).then(n,s);}}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,s,_next,_throw,'next',e);}function _throw(e){asyncGeneratorStep(i,n,s,_next,_throw,'throw',e);}_next(undefined);});};}function $greeting(e){return _$greeting.apply(this,arguments);}function _$greeting(){_$greeting=_async_to_generator(function*(e){yield(0,c.setTimeout)(1000);return`Hello, ${e}!`;});return _$greeting.apply(this,arguments);}const a=[(0,o.GET)(function(){var t=_async_to_generator(function*(t){const r=yield i(e($serpack_cache($greeting(t.params.params),this.context,'$greeting'),this.context,'$greeting'),this.context,'$greeting');t.send(r);});return function(e){return t.apply(this,arguments);};}())];}}));Object.defineProperty(n.exports,'__serpack_module__',{value:!0,enumerable:!!0});var {$serpack_cache:i}=t('sp:5');},'4':function(e,t,r,n){'use strict';var {$serpack_cache:s}=e('sp:5');(function(e){var t={};function __serpack_require__(r){if(!r.startsWith('sp:'))return require(r);if(t[r.slice(3)])return t[r.slice(3)];const n={exports:{}};t[r.slice(3)]='__serpack_module_pending__';e[r.slice(3)].call(n.exports,__serpack_require__,require,n,n.exports);t[r.slice(3)]=n.exports;return n.exports;}r.exports=__serpack_require__('sp:0');}({'0':function(e,t,r,n){'use strict';Object.defineProperty(n,'__esModule',{value:true});Object.defineProperty(n,'default',{enumerable:true,get:function(){return i;}});const s=e('@zely-js/core');const i=[(0,s.GET)(e=>{e.status(404).send({error:`${e.pathname} not found`,code:404});})];}}));Object.defineProperty(r.exports,'__serpack_module__',{value:!0,enumerable:!!0});var {$serpack_cache:s}=e('sp:5');}}));Object.defineProperty(module.exports,'__serpack_module__',{value:!0,enumerable:!!0});var {$serpack_cache:e}=__serpack_require__('sp:3'); }),
});
Object.defineProperty(module.exports, "__serpack_module__", {value:!0, enumerable: !!0});;var {$serpack_cache}=require("@zely-js/optimizer");